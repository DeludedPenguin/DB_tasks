<!DOCTYPE html>
<html>
<head>
    <title>{{ title }}</title>
    <style>
        body { 
            font-family: 'Monaco', 'Menlo', 'Consolas', monospace; 
            margin: 40px; 
            background-color: #2d2d2d; 
            color: #00ff41; 
        }
        .task { 
            padding: 10px; 
            border-bottom: 1px solid #444; 
            display: grid;
            grid-template-columns: 1fr auto auto auto;
            gap: 15px;
            align-items: center;
        }

        .task-content {
            display: flex;
            align-items: center;
            flex-wrap: wrap;
        }

        .task-meta {
            display: flex;
            gap: 10px;
            align-items: center;
            justify-content: flex-end;
            min-width: 120px;
        }

        .task-actions {
            display: flex;
            gap: 8px;
            align-items: center;
            white-space: nowrap;
        }

        .priority-badge {
            min-width: 80px;
            text-align: center;
        }

        .completed { text-decoration: line-through; color: #888; }
        input, button, select { 
            padding: 8px; 
            margin: 5px; 
            background-color: #1a1a1a; 
            color: #00ff41; 
            border: 1px solid #555; 
            font-family: inherit;
        }
        button { background-color: #333; cursor: pointer; }
        button:hover { background-color: #555; }
        .nav { margin-bottom: 20px; }
        .nav a { 
            margin-right: 15px; 
            text-decoration: none; 
            color: #00cc33; 
            font-weight: bold;
        }
        .nav a:hover { color: #00ff41; }
        .delete-btn { 
            background: #ff4444; 
            color: white; 
            border: none; 
            padding: 4px 8px; 
            text-decoration: none;
            font-size: 12px;
        }
        .delete-btn:hover { background: #ff6666; }
        a { color: #00cc33; text-decoration: none; }
        a:hover { color: #00ff41; }
        small { color: #66ff66; }
        .project-tag {
            padding: 2px 8px;
            border-radius: 3px;
            font-size: 12px;
            font-weight: bold;
            margin-right: 8px;
        }
    </style>
</head>
<body>
    <div class="nav">
        <a href="/completed">View Completed Tasks ‚Üí</a>
        <a href="/export/active" style="color: #ffcc00;">üìä Export Active Tasks (CSV)</a>
        <a href="/timer" style="color: #ff6666;">üçÖ Focus Timer</a>
        <a href="/projects" style="color: #66ccff;">üìÅ Projects</a>
    </div>
    
    <h1>{{ title }}</h1>
    
    <form method="POST" action="/add">
        <input type="text" name="task" placeholder="Add a new task..." required>
        <label>Do Date: <input type="date" name="do_date"></label>
        <label>Due Date: <input type="date" name="due_date"></label>
        <label>Priority: 
            <select name="priority">
                <option value="0">None</option>
                <option value="1">Low</option>
                <option value="2">Medium</option>
                <option value="3">High</option>
            </select>
        </label>
        <label>Project: 
            <select name="project_id">
                <option value="">No Project</option>
                {% for project in projects %}
                    <option value="{{ project.id }}">{{ project.name }}</option>
                {% endfor %}
            </select>
        </label>
        <button type="submit">Add Task</button>
    </form>
    
    <h2>Active Tasks:</h2>
    
    {% if tasks %}
        {% for task in tasks %}
            <div class="task {{ 'completed' if task.completed else '' }}">
                <div class="task-content">
                    {% if task.project %}
                        <span class="project-tag" style="background-color: {{ task.project.color }}; color: white;">[{{ task.project.name }}]</span>
                    {% endif %}
                    <span>{{ task.name }}</span>
                </div>
                
                <div class="priority-badge">
                    {% if task.priority_text %}
                        <span style="color: {{ task.priority_color }}; font-weight: bold;">[{{ task.priority_text }}]</span>
                    {% endif %}
                </div>
                
                <div class="task-meta">
                    <small>
                        {% if task.do_date %}Do: {{ task.do_date }}{% endif %}
                        {% if task.due_date %}Due: {{ task.due_date }}{% endif %}
                    </small>
                </div>
                
                <div class="task-actions">
                    {% if not task.completed %}
                        <a href="/complete/{{ task.id }}">‚úì Complete</a>
                        <a href="/edit/{{ task.id }}" style="color: #ffcc00;">‚úèÔ∏è Edit</a>
                    {% endif %}
                    <a href="/delete/{{ task.id }}" class="delete-btn">Delete</a>
                </div>
            </div>
        {% endfor %}
    {% else %}
        <p style="color: #66ff66;">No tasks yet!</p>
    {% endif %}
</body>
</html>